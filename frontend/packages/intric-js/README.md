# Intric.js

Lightweight and typed JS client for the Intric backend.

## Usage

```js
import { createIntric } from "@intric/intric-js";

const intric = createIntric({
  apiKey: <token>,
  baseUrl: <baseUrl>,
});

const groups = await intric.groups.list()
```

Create an `intric` object with the `createIntric()` function. It provides convenience wrapper functions around the Intric API.

### Errors

All Intric functions can throw an `IntricError`, providing a `stage: "JSON" | "HTTP"` and a `request: { endpoint: string; payload?: object; }`, during which the error occured on top of the error's `message`.

## Advanced usage

### Custom fetch function

If you work with a js framework (e.g. SvelteKit) that implements its own fetch function, you can pass it while creating the intric object like so:

```js
import { createIntric } from "@intric/intric-js";

// SvelteKit +layout.js load function
export const load = async (event) => {
  const intric = createIntric({
    token: event.data.token,
    baseUrl: event.data.baseUrl,
    fetch: event.fetch
  });

  return { intric };
};
```

### Typed client

You can query the backend directly through the client's typed fetch function, which migh come in handy if you only need a specific endpoint or need to minimise bundle size.

```js
import { createClient } from "@intric/intric-js";

const client = createClient({
  apiKey: <token>,
  baseUrl: <baseUrl>,
});

const groups = await client.fetch("/api/v1/groups/", { method: "get" })
```

## Development

Intric.js is written as pure JS library with typing provided through TsDoc. Types for the backend are autogenerated from the openapi.json.

### Install dev dependencies

```bash
pnpm install
```

### Update schema

To regnerate/update the backend types run

```bash
pnpm run update && pnpm run lint
```

Update the endpoints accordingly.
